---
title: Larval settlement competency
author: Murray Logan
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    code_folding: hide
    collapse: yes
    df_print: paged
    fig_caption: yes
    fig_height: 4
    fig_width: 4
    highlight: textmate
    theme: spacelab
    toc: yes
    toc_float: yes
    css: style.css
output_dir: "docs"
bibliography: references.bib
---

```{r setup, include=FALSE}
assignInNamespace('.sep.label',  "^\\ *(#|--)+\\s*(@knitr|----+)(.*?)-*\\s*$", ns='knitr')
tidyverse_style_with_comments_removed <- function() {
  remove_comments <- function(pd) {
    is_comment <- pd$token == "COMMENT"
    pd <- pd[!is_comment,]
    pd
  }
  
  tidyverse_with_comments_removed <- styler::tidyverse_style()
  tidyverse_with_comments_removed$token$remove_comments <- remove_comments
  tidyverse_with_comments_removed
}

knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE,cache.lazy = FALSE, tidy='styler',
                      tidy.opts=list(transformers = tidyverse_style_with_comments_removed()))
options(tinytex.engine = 'xelatex')

## knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE,cache.lazy = FALSE, tidy='styler')
## knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, cache = FALSE)
knitr::read_chunk("../scripts/functions.R") 
knitr::read_chunk("../scripts/00_main.R") 
knitr::read_chunk("../scripts/10_processData.R") 
knitr::read_chunk("../scripts/20_fitModels.R") 
knitr::read_chunk("../scripts/30_modelValidations.R") 
knitr::read_chunk("../scripts/40_summariseModels.R") 
knitr::read_chunk("../scripts/50_cue_comparisons.R") 
```

# Info

The code responsible for the described actions can be toggled via the
`hide/code` buttons.

# Preparations {.tabset .tabset-faded}

## Load the packages

1. establish (and if necessary create) a set of paths

```{r paths, results='markdown', eval=TRUE}
```

2. load necessary packages

```{r loadPackages, results='markdown', eval=TRUE}
```

## Load the data

```{r readData, results='markdown', eval=TRUE}
```

## Process the data

We collectively decided that when Larval age is 0, it is physically
impossible for the larvae to settle, and therefore even though it is
not actually measured, we will set the number of settled larvae to be
0 at this age.  Although there has been an attempt to do this is the
dataset, it needs to be done at the Plate level for each Species and
SpecificTreatment.  Therefore I will remove the current attempt and
add a more complete version.

```{r processData, results='markdown', eval=TRUE}
```

## EDA

```{r EDA, results='markdown', eval = FALSE}
```

![](../output/figures/EDA.png)

# Question 1: time to settlement {.tabset .tabset-faded}

The aim of this analysis is to explore the time (age) to settlement
competency associated with different inducers.  To do so, it is
necessary to define settlement competency.  There are numerous
options:

- extract the first time (=age) that any larvae were observed to have
  settled in any replicate of an inducement treatment.  This approach
  assumes that any observed settlement represents the biological
  potential for settlement.  However, it does not necessarily reflect
  the typical behavioural responses to the inducer.

- set a (series) of thresholds on the proportion of larvae that have
  settled in each sampling unit above which, the larval within the
  unit is considered to have demonstrated settlement.  Proportions to
  explore include 0.1, 0.3, and 0.5, representing 10, 30 and 50%
  respectively.  This approach focusses on the combination of
  biological potential for settlement and behavioural response.

In the case of the later, each sampling unit was scored as either 1
(when the proportion of settled larve exceed the threshold proportion
or have done so at an earlier age) or 0 (when the proportion of
settled larvae have yet to exceed the threshold proportion).

## Preparation

1. Set thresholds

```{r setThresholds, results='markdown', eval=TRUE, tidy = TRUE}
```
  
2. Data preparation

	Prepare the data

	1. Score an observation as either 1 (proportion settled greater than
		threshold) or 0 (not greater)

	2. For each species, treatment and plate
		- sort by Larval age
		- score settlement as 1 (has currently or previously obtained a
		settlement proportion greater than the threshold) or 0 (has
		not)

	3. Establish analysis nesting (on Species)

	4. Remove the peptile and extract inducment treatments
       (A.N. suggestion) as arguably these two inducers do not
       represent natural conditions

```{r prepareDataQ1, results='markdown', eval=FALSE}
```

## EDA {.tabset .tabset-pills}

The following exploratory data analysis figures comprise two panels.

In the top panel, the percentage of settlement (Number settled as a
percentage of the Number settled and Number not settled) in each
sampling unit (well) is plotted against larval age (in days)
conditional on the inducer treatments (colours). Faint lines represent
trends within each plate (averaged over wells) and solid lines
represent gam smoothers (binomial family).  Plotting symbols are used
to signify whether larval cohorts exceed the settlement threshold or
not.  Note, this is cummulative, so all larval ages subsequent to an
age that exceeds the threshold will also be deemed to have exceeded
the threshold.  With the exception of the points, this sub-figure will
not change between alternative thresholds.  It is also worth pointing
out that I have not jittered the points and thus there may well be
numerous overlapping points (making the symbols difficult to
distinguish).  Furthermore, symbols further to the right of the
sub-figure are not expected to change between alternative thresholds.

In the bottom panel settlement (cummulative cohort settlement
exceedence from the threshold) is plotted against larval age
conditional on the inducer treatments (colours).  Fain lines represent
thrends within each plate (averaged over wells) and solid lines
represent logistc regression smoothers.


```{r functionEDA, results='markdown', eval=FALSE, echo = TRUE}
```

```{r EDAQ1, results='markdown', eval=FALSE, echo = TRUE}
```
 
```{r load data Q1, results='asis', eval=TRUE, echo=FALSE}
load(paste0(DATA_PATH, "processed/data.q1.RData"))
SPECIES <- data.q1 %>% pull(Species) %>% unique()

for (i in 1:length(SPECIES)) {
    cat(paste0("\n### ", SPECIES[i], " {.tabset .tabset-faded} \n"))
    for (thresholdProp in seq(0.1, 0.9, by = 0.1)) {
        cat(paste0("\n#### Thresh. prop.:", thresholdProp, "\n"))
        cat(paste0("![](../output/figures/eda_",SPECIES[i],"__",thresholdProp,"_.png) \n\n"))
    }
}
```


## Fit model

The relationships between larval settlement and the interaction of
larval age and inducement treatment was explored by hierarchical
logistic models [@Gelman-2007-2007] in a Bayesian framework.

All Bayesian models included 3 chains (NUTS), each with 6000
iterations, thinned to a rate of 10, and excluded the first 2000
iterations (warmup).  Chain mixture and convergence was assessed via
trace plots, autocorrelation plots, Rhat and effective sample size
diagnostics.  Models were also validated via DHARMa [@Hartig-2022]
simulated residuals
  
All statistical models were performed in the R (4.2.1) Statistical and
Graphical Environment [@RCoreTeam-2022] via the _brms_ [@Burkner-2021]
package

 

```{r functionFitModel, results='markdown', eval=FALSE}
```

```{r fitModelQ1, results='markdown', eval=FALSE}
```

```{r load modelled Q1, results='asis', eval=TRUE}
load(paste0(DATA_PATH, "modelled/data.q1.mod.RData"))
SPECIES <- data.q1.mod %>% pull(Species) %>% unique()
```
    
## Diagnostics {.tabset .tabset-pills}

A quick scan of all the MCMC and residual diagnostics suggests that:

- the chains are well mixed (trace plots very noisy and consistently
  so for each chain)
- no autocorrelation amongst retained draws
- the chains have converged (all Rhat values < 1.01)
- the No-U-Turn (NUTS) sampler appears to have sampled effectively
  (all ESS/Sample size values > 0.5)
- there is no evidence of a lack of fit (DHARMa residuals did not
  reveal any major issues)

```{r functionMCMCdiagnostics, results='markdown', eval=FALSE}
```

```{r functionDHARMa, results='markdown', eval=FALSE}
```

```{r MCMCdiagnosticsQ1, results='markdown', eval=FALSE}
```

```{r MCMCplots modelled Q1, results='asis', eval=TRUE, echo = FALSE}
for (i in 1:length(SPECIES)) {
    cat(paste0("\n### ", SPECIES[i], " {.tabset .tabset-faded} \n"))
    for (thresholdProp in seq(0.1, 0.9, by = 0.1)) {
        cat(paste0("\n#### Thresh. prop.:", thresholdProp, "\n"))
        cat(paste0("![](../output/figures/Trace_",SPECIES[i],"__",thresholdProp,"_.png) \n"))
        cat(paste0("![](../output/figures/AC_",SPECIES[i],"__",thresholdProp,"_.png) \n"))
        cat(paste0("![](../output/figures/Rhat_",SPECIES[i],"__",thresholdProp,"_.png) \n"))
        cat(paste0("![](../output/figures/ess_",SPECIES[i],"__",thresholdProp,"_.png) \n"))
        cat(paste0("![](../output/figures/DHARMa_",SPECIES[i],"__",thresholdProp,"_.png) \n"))
    }
}
```

## Partial plots {.tabset .tabset-pills}

The following figures display the expected cohort settlement
probability (of exceeding threshold) associated with larval age for
each inducer treatment.  Solid lines represent posterior medians and
ribbons represent associated 95% credibility intervals.

```{r functionPartials, results='markdown', eval=FALSE}
```
```{r functionPartialPlot, results='markdown', eval=FALSE}
```

```{r partialsQ1, results='markdown', eval=FALSE}
```
```{r partialPlotQ1, results='markdown', eval=FALSE}
```

```{r PartialPlots  Q1, results='asis', eval=TRUE, echo = FALSE}
for (i in 1:length(SPECIES)) {
    cat(paste0("\n### ", SPECIES[i], " {.tabset .tabset-faded} \n"))
    for (thresholdProp in seq(0.1, 0.9, by = 0.1)) {
        cat(paste0("\n#### Thresh. prop.:", thresholdProp, "\n"))
        cat(paste0("![](../output/figures/PartialPlot_",SPECIES[i],"__",thresholdProp,"_.png) \n"))
    }
}
```

## LD50 {.tabset .tabset-pills}

One measure of the time (age) to settlement competency could be the
_LD50_ - the so called 'leathal dose 50' which estimates the value
along the x-axis that is associated with the inflection point (point
at which the response switches from more to less likely, e.i. a
probability of 0.5).  In the current context, this would represent the
age at which the cohort is more likely to have exceeded the threshold
settlement.  Whilst the absolute value of this measure might only have
a tenuous interpretation in this context, the pairwise differences
between LD50 associated with each inducer treatment does provide a
means to compare settlement competency ties between inducer
treatments.  The differences are presented in units of age and thus:

- positive numbers indicate that the first treatment in the comparison
  (variable) is associated with a more protracted age to cohort
  settlement
- negative numbers indicate that the first treatment in the comparison
  (variable) is associated with faster cohort
  settlement
- the magnitude of the values is a reflection of the degree of
  difference in cohort settlement competency ages between the inducer
  treatments.
- Exceedence probabilies are used to enumerate the strength of the
  evidence that the difference is greater (or less) than 0 (no
  effect).  Exceedence probabilities (P>0) between 0.9 and 0.95
  indicate _evidence_ that the age to cohort settlement competency is
  more protracted for the rist treatment in the comparison.  Values
  above 0.95 indicate _strong evidence_.  Exceedence probabilities
  (P<0) reverse the polarity of the comparison.

```{r functionLD50, results='markdown', eval=FALSE}
```
```{r functionLD50dif, results='markdown', eval=FALSE}
```
```{r function pairwise tests, results='markdown', eval=FALSE}
```

```{r LD50Q1, results='markdown', eval=FALSE}
```

```{r LD50Tables  Q1, results='asis', eval=TRUE, echo = FALSE}
files <- list.files(path = paste0(DATA_PATH, "modelled"),
                    pattern = "data.q1.*mod_sum.RData",
                    full.names = TRUE)
load(files[1])
SPECIES <- data.q1.mod %>% pull(Species) %>% unique()
for (i in 1:length(SPECIES)) {
    cat(paste0("\n### ", SPECIES[i], " {.tabset .tabset-faded} \n"))
    for (thresholdProp in seq(0.1, 0.9, by = 0.1)) {
        cat(paste0("\n#### Thresh. prop.:", thresholdProp, "\n"))
        load(paste0(DATA_PATH, "modelled/data.q1__",thresholdProp,".mod_sum.RData"))
        print(data.q1.mod[i,'LD50tab'][[1]][[1]] %>%
              knitr::kable(caption = "Estimated larval age (95% CI) at which larval cohort are considered more likely to have settled than not settled per inducer treatment."))
        cat('\n')
        print(data.q1.mod[i,'LD50dif'][[1]][[1]] %>%
              knitr::kable(caption = "Pairwise comparisons of estimated larval age at which larval cohorts are considered more likely to have settled than not settled between inducer treatments. Exceedence probabilities of effects greater than and less than 0 also provided."))
        cat('\n')
    }
}
```
 
## Odds ratios {.tabset .tabset-pills}

Odds ratios of the partial slopes provide a measure of the rate at
which the odds of cohort settlement competency change per unit change
of larval age.  Odds above 1 indicate that the odds of cohort
settlement competency increase with every additional day of larval
age.  Odds values of 1.5, 2 and 3 represent fractional changes in odds
of 50%, 100% (doubling) and 200% respectively for every addional day
of larval age.  The larger the value, the steeper the rate of change
in cohort settlement probability.

Pairwise comparisons of cohort settlement odds provide a way to
compare the treatments.  These differences are presented on an odds
ratio scale:

- values between 0 and 1 indicate that the first treatment in the
  comparison (variable) has a slower rate of cohort settlement change.  For
  example, a value of 0.5 would indicate that the rate associated with
  the first tteatment is half that of the second.
- values above 1 indicate that the first treatment in the comparison
  (variable) has a faster rate of cohort settlement change.  A value
  of 1.5 indicates a 50% increase in cohort settlement change.

```{r functionoddsQ1, results='markdown', eval=FALSE}
```
```{r oddsQ1, results='markdown', eval=FALSE}
```

```{r oddsTables  Q1, results='asis', eval=TRUE, echo = FALSE}
files <- list.files(path = paste0(DATA_PATH, "modelled"),
                    pattern = "data.q1.*mod_sum.RData",
                    full.names = TRUE)
load(files[1])
SPECIES <- data.q1.mod %>% pull(Species) %>% unique()
for (i in 1:length(SPECIES)) {
    cat(paste0("\n### ", SPECIES[i], " {.tabset .tabset-faded} \n"))
    for (thresholdProp in seq(0.1, 0.9, by = 0.1)) {
        cat(paste0("\n#### Thresh. prop.:", thresholdProp, "\n"))
        load(paste0(DATA_PATH, "modelled/data.q1__",thresholdProp,".mod_sum.RData"))
        print(data.q1.mod[i,'Oddstab'][[1]][[1]] %>%
              knitr::kable(caption = "Estimated rate of change in above threshold cohort settlement probability per unit of larval age change (odds ratio scale) per inducer treatment."))
        cat('\n')
        print(data.q1.mod[i,'Oddsdif'][[1]][[1]] %>%
              knitr::kable(caption = "Pairwise comparisons of estimated odds of above threshold cohort settlement between inducer treatments. Exceedence probabilities of effects greater than and less than 0 also provided."))
        cat('\n')
    }
}
```

## Compilation of partial plots {.tabset .tabset-faded}

```{r functionCompilation, results='markdown', eval=FALSE}
```
```{r compilationQ1, results='markdown', eval=FALSE}
```
 
```{r compilationPlots  Q1, results='asis', eval=TRUE, echo = FALSE}
files <- list.files(path = paste0(OUTPUT_PATH, "/figures"),
                    pattern = "compilation.*.png",
                    full.names = TRUE)
thresholdProp <- str_replace(files, ".*compilation_(.*)_.png", "\\1")
for (thresh in thresholdProp) {

    cat(paste0("\n### Thresh. prop.:", thresh, "\n"))
    cat(paste0("![](../output/figures/compilation_",thresh,"_.png) \n"))
    cat('\n')
}
```

## Days vs Threshold {.tabset .tabset-faded}

```{r days_vs_thresholdQ1, results='markdown', eval=FALSE}
```

```{r days_vs_threshold Q1, results='asis', eval=TRUE, echo = FALSE}
files <- list.files(path = paste0(OUTPUT_PATH, "/figures"),
                    pattern = "all_LD50.*.png",
                    full.names = TRUE)
Species <- str_replace(files, '.*__(.*)_.png', '\\1')
for (Sp in Species) {

    cat(paste0("\n### ", Sp, "\n"))
    cat(paste0("![](../output/figures/all_LD50__",Sp,"_.png) \n"))
    cat('\n')
}
```

# Question 2: effects of inducer type on settlement compentency {.tabset .tabset-faded}

```{r GetSpecies, results='markdown', eval=TRUE}
SPECIES <- data.q1.mod %>% pull(Species) %>% unique()
```

The aim of this component is to compare larval settlement competency
in association with each of the major inducers (CCA, disc, rubble and
control) for each coral species.  The approach that we will take is:

- fit Bayesian generalised additive hierarchical models to model the
  proportion of settled larvae against a cubic regression spline for
  larval age conditional on inducer type separately for each species.
  Each model will also include a varying ('random') effect of plate so
  as to account for the dependency structure.  
- since the dataset is relatively small, there is a danger of
  overfitting.  To protect against this, we will restrict the maximum
  number of spline knots to 5 rather than permitting the models to
  self-select.  A value of 5 was chosen to permit a reasonable degree
  of trend tortuosity whilst preventing illogical or unreasonable
  pertebations resulting from unusual values (that are more common in
  small datasets).
- estimate the partial trends associated with each inducer by
  calculating posterior effects marginalising over plate.
- calculate the area under each spline trend by numerical integration
  at a resolution of 100 for each posterior draw
- perform pairwise contrasts of the full posterior areas and express
  the results both graphically and in summary tables.
- in the resulting Area Under Curve tables, posterior distribution of
  the estimates are summarised as median and lower/upper Highest
  Posterior Distribution (HPD) intervals.
- tables of pairwise differences also include exceedence probabilities
  associated with the differences (P>0).  By way of reference, an exceedence
  probability of 0.9 for a comparison of (A - B) indicates that we are
  90% confident that the area under the curve for inducer A is greater
  than that of inducer B.  Since this is a one-tailed test (only tests
  for change in one direction), I have also included the reciprocal
  (P<0).
- the differences are expressed in absolute differences (first
  pairwise diff table in the section) as well as in fractional
  differences (second pairwise diff table in the section).  On a
  fractional scale, a value of 1 indicates no change (e.i. multiply a
  value by 1 - no change).  Values of 0.5 and 2 represent halving and
  doubling respectively (or 50% decline and 100% increase
  respectively).
  
## Fit model

```{r functionfitModelQ2, results='markdown', eval=FALSE}
```

```{r fitModel Q2, results='markdown', eval=FALSE}
```

```{r save Models Q2, results='markdown', eval=FALSE}
```

## Diagnostics {.tabset .tabset-pills}

A quick scan of all the MCMC and residual diagnostics suggests that:

- the chains are well mixed (trace plots very noisy and consistently
  so for each chain)
- no autocorrelation amongst retained draws
- the chains have converged (all Rhat values < 1.01)
- the No-U-Turn (NUTS) sampler appears to have sampled effectively
  (all ESS/Sample size values > 0.5)
- there is no evidence of a lack of fit (DHARMa residuals did not
  reveal any major issues)

```{r functionMCMCdiagnostics, results='markdown', eval=FALSE}
```

```{r functionDHARMaQ2, results='markdown', eval=FALSE}
```

```{r MCMCdiagnostics Q2, results='markdown', eval=FALSE}
```

```{r MCMCplots modelled Q2, results='asis', eval=TRUE, echo = FALSE}
for (i in 1:length(SPECIES)) {
    cat(paste0("\n### ", SPECIES[i], " {.tabset .tabset-faded} \n"))
    if (file.exists(paste0('../output/figures/Trace_',SPECIES[i],"_.png"))) {
        cat(paste0("![](../output/figures/Trace_",SPECIES[i],"_.png) \n"))
        cat(paste0("![](../output/figures/AC_",SPECIES[i],"_.png) \n"))
        cat(paste0("![](../output/figures/Rhat_",SPECIES[i],"_.png) \n"))
        cat(paste0("![](../output/figures/ess_",SPECIES[i],"_.png) \n"))
        cat(paste0("![](../output/figures/DHARMa_",SPECIES[i],"_.png) \n"))
    }
}
```

## Partial plots {.tabset .tabset-pills}

The following figures display the expected cohort settlement
probability (of exceeding threshold) associated with larval age for
each inducer treatment.  Solid lines represent posterior medians and
ribbons represent associated 95% credibility intervals.

```{r functionPartials, results='markdown', eval=FALSE}
```
```{r functionPartialPlot, results='markdown', eval=FALSE}
```

```{r partialsQ2, results='markdown', eval=FALSE}
```
```{r partialPlotQ2, results='markdown', eval=FALSE}
```

```{r PartialPlots  Q2, results='asis', eval=TRUE, echo = FALSE}
for (i in 1:length(SPECIES)) {
    cat(paste0("\n### ", SPECIES[i], " {.tabset .tabset-faded} \n"))
    if (file.exists(paste0('../output/figures/PartialPlot_',SPECIES[i],"__.png"))) {
        cat(paste0("![](../output/figures/PartialPlot_",SPECIES[i],"__.png) \n"))
    }
}
```

## Area under curves {.tabset .tabset-pills}

<details><summary>Code</summary>
```{r functionAUCQ2, results='markdown', eval=FALSE}
```
```{r functionAUCPlot, results='markdown', eval=FALSE}
```
```{r functionAUC_diff, results='markdown', eval=FALSE}
```
```{r functionAUC_ratio, results='markdown', eval=FALSE}
```
```{r functionAUC_diff_sums, results='markdown', eval=FALSE}
```
```{r functionAUC_ratio_sums, results='markdown', eval=FALSE}
```
```{r functionAUC_diff_plot, results='markdown', eval=FALSE}
```
```{r functionAUC_ratio_plot, results='markdown', eval=FALSE}
```
```{r areaQ2, results='markdown', eval=FALSE}
```

```{r compare_Areas Q2, results='markdown', eval=FALSE}
```
```{r compare_Areas_sums Q2, results='markdown', eval=FALSE}
```
```{r compare_Areas_plots Q2, results='markdown', eval=FALSE}
```
</details>

```{r AreaPlotsTables  Q2, results='asis', eval=TRUE, echo = FALSE}
load(file = paste0('../data/modelled/data.q2.mod_areas_sums.RData'))
SPECIES <- data.q2.mod %>% pull(Species) %>% unique
for (i in 1:length(SPECIES)) {
    cat(paste0("\n### ", SPECIES[i], " {.tabset .tabset-faded} \n"))
    if (file.exists(paste0('../output/figures/PartialArea_',SPECIES[i],"__.png"))) {

    cat(':::: {.columns}:\n\n')
    cat('::: {.column .center style="width:45%;"}\n\n')
    print(data.q2.mod[i,'Area_sums'][[1]][[1]] %>%
          filter(variable == 'Area') %>%
          rename(Inducer = SpecificTreatment) %>%
          knitr::kable(caption = "Estimated area under curve per inducer treatment."))
    cat(':::\n\n')
    cat('::: {.column .center style="width:55%;"}\n\n')
    cat(paste0("![Posterior distribution of areas under curve per inducer treatments](../output/figures/PartialArea_",SPECIES[i],"__.png) \n"))
    cat(':::\n\n')
    cat('::::\n\n')
    
    print(data.q2.mod[i,'Areas_diff_sums'][[1]][[1]] %>%
          filter(variable == 'Area') %>%
          rename(Inducer = SpecificTreatment) %>%
          knitr::kable(caption = "Estimated pairwise differences in area under curve between inducer treatments."))
    cat('\n')
    print(data.q2.mod[i,'Areas_ratio_sums'][[1]][[1]] %>%
          filter(variable == 'Area') %>%
          rename(Inducer = SpecificTreatment) %>%
          knitr::kable(caption = "Estimated pairwise differences (on a fractional scale) in area under curve between inducer treatments."))
    cat('\n')
    cat(':::: {.columns}:\n\n')
    cat('::: {.column .center style="width:49%;"}\n\n')
    cat(paste0("![Pairwise differences in areas under curves.](../output/figures/PartialAreaDiffs_",SPECIES[i],"__.png) \n"))
    cat(':::\n\n')
    cat('::: {.column .center style="width:49%;"}\n\n')
    cat(paste0("![Pairwise differences (fractional scale) in areas under curves.](../output/figures/PartialAreaRatios_",SPECIES[i],"__.png) \n"))
    cat(':::\n\n')
    cat('::::\n\n')
    }
    
}
```

  
# Preparation notes

- the full codebase for this project can be found 
  [on github](https://github.com/open-AIMS/larval_settlement_competency)

# References
